<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="400" viewBox="0 0 800 400" fill="none" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision">
    <!-- Background -->
    <rect width="800" height="400" fill="#f8f9fa"/>
    
    <!-- Title -->
    <text x="400" y="40" font-family="JetBrains Mono, monospace" font-size="20" font-weight="bold" fill="#333" text-anchor="middle">Rust 迭代器 vs C 语言循环</text>
    
    <!-- C Language Side -->
    <rect x="50" y="80" width="340" height="280" rx="8" fill="#ffebee" stroke="#ef5350" stroke-width="2"/>
    <text x="70" y="110" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#ef5350">C Style (Manual)</text>
    
    <text x="70" y="140" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">int* ptr = arr;</text>
    <text x="70" y="155" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">int* end = arr + len;</text>
    <text x="70" y="170" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">for (; ptr &lt; end; ptr++) {</text>
    <text x="70" y="185" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">    int val = *ptr * 2;</text>
    <text x="70" y="200" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">    if (val &gt; 2) {</text>
    <text x="70" y="215" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">        sum += val;</text>
    <text x="70" y="230" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">    }</text>
    <text x="70" y="245" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">}</text>
    
    <rect x="70" y="270" width="300" height="70" rx="4" fill="#fff" stroke="#ef5350" stroke-dasharray="4 2"/>
    <text x="80" y="290" font-family="JetBrains Mono, monospace" font-size="11" fill="#ef5350">⚠️ 风险：</text>
    <text x="80" y="305" font-family="JetBrains Mono, monospace" font-size="11" fill="#333">- 指针越界 (Buffer Overflow)</text>
    <text x="80" y="320" font-family="JetBrains Mono, monospace" font-size="11" fill="#333">- 迭代器失效 (Iterator Invalidation)</text>

    <!-- Rust Side -->
    <rect x="410" y="80" width="340" height="280" rx="8" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
    <text x="430" y="110" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#4caf50">Rust Iterator (Declarative)</text>
    
    <text x="430" y="140" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">let sum: i32 = arr.iter()</text>
    <text x="430" y="155" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">    .map(|x| x * 2)</text>
    <text x="430" y="170" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">    .filter(|x| *x &gt; 2)</text>
    <text x="430" y="185" font-family="JetBrains Mono, monospace" font-size="12" fill="#333">    .sum();</text>
    
    <rect x="430" y="210" width="300" height="130" rx="4" fill="#fff" stroke="#4caf50" stroke-dasharray="4 2"/>
    <text x="440" y="230" font-family="JetBrains Mono, monospace" font-size="11" fill="#4caf50">✅ 优势：</text>
    <text x="440" y="245" font-family="JetBrains Mono, monospace" font-size="11" fill="#333">- 编译期安全检查 (Lifetime)</text>
    <text x="440" y="260" font-family="JetBrains Mono, monospace" font-size="11" fill="#333">- 循环融合 (Loop Fusion)</text>
    <text x="440" y="275" font-family="JetBrains Mono, monospace" font-size="11" fill="#333">- 零成本：生成与 C 等效的汇编</text>
    <text x="440" y="300" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#4caf50">底层汇编：</text>
    <text x="440" y="315" font-family="JetBrains Mono, monospace" font-size="11" fill="#78909c">Same tightly packed loop!</text>

    <!-- Comparison Note -->
    <text x="400" y="385" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c" text-anchor="middle">逻辑上更优雅，性能上不打折</text>
</svg>